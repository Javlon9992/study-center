<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Center CRM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', sans-serif; }
        .navbar { box-shadow: 0 2px 4px rgba(0,0,0,.1); }
        .card { border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,.05); }
        .card-header { background: white; border-bottom: 1px solid #eee; font-weight: bold; padding: 15px 20px; border-radius: 12px 12px 0 0 !important; }
        .btn-custom { background: #4f46e5; color: white; padding: 10px 20px; width: 100%; font-weight: 600; }
        .btn-custom:hover { background: #4338ca; color: white; }
        .table th { background-color: #f8f9fa; color: #495057; font-weight: 600; }
        .avatar { width: 35px; height: 35px; background: #e0e7ff; color: #4f46e5; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px; }
    </style>
</head>
<body>

    <nav class="navbar navbar-light bg-white mb-4">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <i class="fas fa-graduation-cap fa-lg text-primary me-2"></i>
                <span class="fw-bold text-primary">Study Center</span> <span class="text-muted ms-2">| CRM</span>
            </a>
            <div class="d-flex align-items-center">
                <span class="badge bg-primary rounded-pill me-2">{{ students.count }} ta o'quvchi</span>
                <i class="fas fa-user-circle fa-2x text-secondary"></i>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-header text-primary">
                        <i class="fas fa-user-plus me-2"></i> Yangi talaba
                    </div>
                    <div class="card-body">
                        <form method="POST">
    {% csrf_token %}
    
    <div class="mb-3">
        <label class="form-label text-muted small">Ism</label>
        {{ form.ism }}
    </div>

    <div class="mb-3">
        <label class="form-label text-muted small">Familiya</label>
        {{ form.familiya }}
    </div>

    <div class="mb-3">
        <label class="form-label text-muted small">Telefon raqam</label>
        {{ form.telefon }}
    </div>

    <div class="mb-3">
        <label class="form-label text-muted small">Qaysi kurs?</label>
        {{ form.fan }}
    </div>

    <div class="mb-4 d-flex align-items-center p-2 border rounded bg-white">
        {{ form.tolov_qildi }}
        <span class="ms-2 text-dark">To'lov qilganmi? (Ha/Yo'q)</span>
    </div>

    <button type="submit" class="btn btn-custom shadow-sm">
        <i class="fas fa-save me-2"></i> Saqlash
    </button>
</form>
                    </div>
                </div>
            </div>

            <div class="col-md-8">
                <div class="card">
                   <div class="card-header d-flex justify-content-between align-items-center flex-wrap">
    <span><i class="fas fa-list me-2"></i> Talabalar ro'yxati</span>
    
    <form method="GET" class="d-flex gap-2" style="max-width: 300px;">
        <div class="input-group input-group-sm">
            <input type="text" name="q" class="form-control" placeholder="Ism yoki Telefon..." value="{{ qidiruv_sozi }}">
            <button class="btn btn-primary" type="submit">
                <i class="fas fa-search"></i> Izlash
            </button>
            {% if qidiruv_sozi %}
            <a href="{% url 'index' %}" class="btn btn-outline-secondary" title="Tozalash">
                <i class="fas fa-times"></i>
            </a>
            {% endif %}
        </div>
    </form>
    
</div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
    <thead class="bg-light">
        <tr>
            <th class="ps-4">F.I.SH</th>
            <th>Kurs</th> <th>To'lov</th> <th>Telefon</th>
            <th class="text-end pe-4">Amallar</th>
        </tr>
    </thead>
    <tbody>
        {% for student in students %}
        <tr>
            <td class="ps-4">
                <div class="d-flex align-items-center">
                    <div class="avatar">
                        {{ student.ism|slice:":1" }}
                    </div>
                    <div>
                        <div class="fw-bold text-dark">{{ student.ism }} {{ student.familiya }}</div>
                        <small class="text-muted">ID: #{{ student.id }}</small>
                    </div>
                </div>
            </td>
            
            <td>
                <span class="badge bg-info text-dark">{{ student.fan }}</span>
            </td>

            <td>
                {% if student.tolov_qildi %}
                    <span class="badge bg-success"><i class="fas fa-check-circle"></i> To'langan</span>
                {% else %}
                    <span class="badge bg-danger"><i class="fas fa-times-circle"></i> Qarzdor</span>
                {% endif %}
            </td>

            <td>
                <span class="badge bg-light text-dark border">
                    <i class="fas fa-phone-alt me-1 text-secondary small"></i> {{ student.telefon }}
                </span>
            </td>
            <td class="text-end pe-4">
                <a href="{% url 'delete_student' student.id %}" 
                   class="btn btn-outline-danger btn-sm" 
                   onclick="return confirm('O\'chirmoqchimisiz?');">
                    <i class="fas fa-trash-alt"></i>
                </a>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5" class="text-center text-muted">Talabalar yo'q</td></tr>
        {% endfor %}
    </tbody>
</table>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

</body>
</html>